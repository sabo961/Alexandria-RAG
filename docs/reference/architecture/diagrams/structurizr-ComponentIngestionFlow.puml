@startuml
title <size:24>Dynamic View: Alexandria RAG System - Scripts Package</size>\n<size:24>Detailed component interactions during book ingestion</size>

set separator none
left to right direction
skinparam ranksep 60
skinparam nodesep 30
hide stereotype

<style>
  root {
    BackgroundColor: #ffffff;
    FontColor: #444444;
  }
  // Element,Component
  .Element-RWxlbWVudCxDb21wb25lbnQ= {
    BackgroundColor: #85bbf0;
    LineColor: #5d82a8;
    LineStyle: 0;
    LineThickness: 2;
    FontColor: #000000;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
    MaximumWidth: 450;
  }
  // Relationship
  .Relationship-UmVsYXRpb25zaGlw {
    LineThickness: 2;
    LineStyle: 10-10;
    LineColor: #444444;
    FontColor: #444444;
    FontSize: 24;
  }
  // Alexandria RAG System
  .Boundary-QWxleGFuZHJpYSBSQUcgU3lzdGVt {
    BackgroundColor: #ffffff;
    LineColor: #0b4884;
    LineStyle: 0;
    LineThickness: 2;
    FontColor: #ffffff;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
  }
  // Scripts Package
  .Boundary-U2NyaXB0cyBQYWNrYWdl {
    BackgroundColor: #ffffff;
    LineColor: #2e6295;
    LineStyle: 0;
    LineThickness: 2;
    FontColor: #ffffff;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
  }
</style>

rectangle "Alexandria RAG System\n<size:16>[Software System]</size>" <<Boundary-QWxleGFuZHJpYSBSQUcgU3lzdGVt>> {
  rectangle "Scripts Package\n<size:16>[Container: Python 3.14]</size>" <<Boundary-U2NyaXB0cyBQYWNrYWdl>> {
    component "==Ingestion Engine\n<size:16>[Component: batch_ingest.py, ingest_books.py]</size>\n\nProcesses EPUB/PDF/TXT/MD books into chunks and uploads to Qdrant" <<Element-RWxlbWVudCxDb21wb25lbnQ=>> as AlexandriaRAGSystem.ScriptsPackage.IngestionEngine
    component "==Chunking Strategies\n<size:16>[Component: philosophical_chunking.py]</size>\n\nDomain-specific chunking (technical, psychology, philosophy, history) with argument-based pre-chunking for philosophical texts" <<Element-RWxlbWVudCxDb21wb25lbnQ=>> as AlexandriaRAGSystem.ScriptsPackage.ChunkingStrategies
    component "==Collection Management\n<size:16>[Component: collection_manifest.py, qdrant_utils.py]</size>\n\nTracks ingested books via per-collection manifests, CSV exports, and Qdrant statistics" <<Element-RWxlbWVudCxDb21wb25lbnQ=>> as AlexandriaRAGSystem.ScriptsPackage.CollectionManagement
    component "==Calibre Integration\n<size:16>[Component: calibre_db.py]</size>\n\nDirect SQLite access to Calibre library for metadata and direct ingestion" <<Element-RWxlbWVudCxDb21wb25lbnQ=>> as AlexandriaRAGSystem.ScriptsPackage.CalibreIntegration
  }

}

AlexandriaRAGSystem.ScriptsPackage.CalibreIntegration --> AlexandriaRAGSystem.ScriptsPackage.IngestionEngine <<Relationship-UmVsYXRpb25zaGlw>> : "1: Provides book path and metadata"
AlexandriaRAGSystem.ScriptsPackage.IngestionEngine --> AlexandriaRAGSystem.ScriptsPackage.ChunkingStrategies <<Relationship-UmVsYXRpb25zaGlw>> : "2: Applies domain-specific chunking"
AlexandriaRAGSystem.ScriptsPackage.IngestionEngine <-- AlexandriaRAGSystem.ScriptsPackage.ChunkingStrategies <<Relationship-UmVsYXRpb25zaGlw>> : "3: Returns chunks"
AlexandriaRAGSystem.ScriptsPackage.IngestionEngine --> AlexandriaRAGSystem.ScriptsPackage.CollectionManagement <<Relationship-UmVsYXRpb25zaGlw>> : "4: Logs to manifest"

@enduml