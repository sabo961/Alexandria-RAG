@startuml
title <size:24>Dynamic View: Alexandria RAG System</size>\n<size:24>Illustrates the book ingestion process from selection to Qdrant upload</size>

set separator none
left to right direction
skinparam ranksep 60
skinparam nodesep 30
hide stereotype

<style>
  root {
    BackgroundColor: #ffffff;
    FontColor: #444444;
  }
  // Element,Container
  .Element-RWxlbWVudCxDb250YWluZXI= {
    BackgroundColor: #438dd5;
    LineColor: #2e6295;
    LineStyle: 0;
    LineThickness: 2;
    RoundCorner: 20;
    FontColor: #ffffff;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
    MaximumWidth: 450;
  }
  // Element,Container,Database
  .Element-RWxlbWVudCxDb250YWluZXIsRGF0YWJhc2U= {
    BackgroundColor: #438dd5;
    LineColor: #2e6295;
    LineStyle: 0;
    LineThickness: 2;
    FontColor: #ffffff;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
    MaximumWidth: 450;
  }
  // Element,Container,Storage
  .Element-RWxlbWVudCxDb250YWluZXIsU3RvcmFnZQ== {
    BackgroundColor: #438dd5;
    LineColor: #2e6295;
    LineStyle: 0;
    LineThickness: 2;
    FontColor: #ffffff;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
    MaximumWidth: 450;
  }
  // Element,Container,Web Browser
  .Element-RWxlbWVudCxDb250YWluZXIsV2ViIEJyb3dzZXI= {
    BackgroundColor: #438dd5;
    LineColor: #2e6295;
    LineStyle: 0;
    LineThickness: 2;
    FontColor: #ffffff;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
    MaximumWidth: 450;
  }
  // Element,Person
  .Element-RWxlbWVudCxQZXJzb24= {
    BackgroundColor: #08427b;
    LineColor: #052e56;
    LineStyle: 0;
    LineThickness: 2;
    FontColor: #ffffff;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
    MaximumWidth: 450;
  }
  // Element,Software System,External System
  .Element-RWxlbWVudCxTb2Z0d2FyZSBTeXN0ZW0sRXh0ZXJuYWwgU3lzdGVt {
    BackgroundColor: #999999;
    LineColor: #6b6b6b;
    LineStyle: 0;
    LineThickness: 2;
    RoundCorner: 20;
    FontColor: #ffffff;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
    MaximumWidth: 450;
  }
  // Relationship
  .Relationship-UmVsYXRpb25zaGlw {
    LineThickness: 2;
    LineStyle: 10-10;
    LineColor: #444444;
    FontColor: #444444;
    FontSize: 24;
  }
  // Alexandria RAG System
  .Boundary-QWxleGFuZHJpYSBSQUcgU3lzdGVt {
    BackgroundColor: #ffffff;
    LineColor: #0b4884;
    LineStyle: 0;
    LineThickness: 2;
    FontColor: #ffffff;
    FontSize: 24;
    HorizontalAlignment: center;
    Shadowing: 0;
  }
</style>

rectangle "Alexandria RAG System\n<size:16>[Software System]</size>" <<Boundary-QWxleGFuZHJpYSBSQUcgU3lzdGVt>> {
  folder "==File System\n<size:16>[Container: File System]</size>\n\nBook storage (ingest/, ingested/) and logs (logs/)" <<Element-RWxlbWVudCxDb250YWluZXIsU3RvcmFnZQ==>> as AlexandriaRAGSystem.FileSystem
  database "==Calibre Database\n<size:16>[Container: SQLite (metadata.db)]</size>\n\nBook metadata (title, author, series, tags, languages)" <<Element-RWxlbWVudCxDb250YWluZXIsRGF0YWJhc2U=>> as AlexandriaRAGSystem.CalibreDatabase
  rectangle "==Streamlit GUI\n<size:16>[Container: Python 3.14, Streamlit]</size>\n\nWeb-based interface for browsing, ingesting, and querying books" <<Element-RWxlbWVudCxDb250YWluZXIsV2ViIEJyb3dzZXI=>> as AlexandriaRAGSystem.StreamlitGUI
  rectangle "==Scripts Package\n<size:16>[Container: Python 3.14]</size>\n\nCore business logic for ingestion, chunking, querying, and management" <<Element-RWxlbWVudCxDb250YWluZXI=>> as AlexandriaRAGSystem.ScriptsPackage
}

person "==Developer/Researcher\n<size:16>[Person]</size>\n\nUses Alexandria to search and analyze books for insights and knowledge synthesis" <<Element-RWxlbWVudCxQZXJzb24=>> as DeveloperResearcher
rectangle "==Qdrant Vector DB\n<size:16>[Software System]</size>\n\nVector search engine storing 384-dim embeddings with domain/book/author metadata" <<Element-RWxlbWVudCxTb2Z0d2FyZSBTeXN0ZW0sRXh0ZXJuYWwgU3lzdGVt>> as QdrantVectorDB

DeveloperResearcher --> AlexandriaRAGSystem.StreamlitGUI <<Relationship-UmVsYXRpb25zaGlw>> : "1: Selects books from Calibre library"
AlexandriaRAGSystem.StreamlitGUI --> AlexandriaRAGSystem.ScriptsPackage <<Relationship-UmVsYXRpb25zaGlw>> : "2: Calls calibre_db.get_all_books()"
AlexandriaRAGSystem.ScriptsPackage --> AlexandriaRAGSystem.CalibreDatabase <<Relationship-UmVsYXRpb25zaGlw>> : "3: Queries book metadata"
AlexandriaRAGSystem.StreamlitGUI --> AlexandriaRAGSystem.ScriptsPackage <<Relationship-UmVsYXRpb25zaGlw>> : "4: Triggers ingest_books.py with domain"
AlexandriaRAGSystem.ScriptsPackage --> AlexandriaRAGSystem.FileSystem <<Relationship-UmVsYXRpb25zaGlw>> : "5: Reads book file (EPUB/PDF/TXT)"
AlexandriaRAGSystem.ScriptsPackage --> QdrantVectorDB <<Relationship-UmVsYXRpb25zaGlw>> : "6: Uploads chunks with embeddings"
AlexandriaRAGSystem.ScriptsPackage --> AlexandriaRAGSystem.FileSystem <<Relationship-UmVsYXRpb25zaGlw>> : "7: Writes manifest JSON/CSV"
DeveloperResearcher <-- AlexandriaRAGSystem.StreamlitGUI <<Relationship-UmVsYXRpb25zaGlw>> : "8: Displays ingestion success"

@enduml